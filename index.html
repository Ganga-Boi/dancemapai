# index.html

```html
<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DanceMap</title>
  <style>
    :root { color-scheme: dark; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#0b0f14; color:#e8eef7; }
    .wrap { max-width:480px; margin:0 auto; height:100vh; display:flex; flex-direction:column; }
    .header { padding:14px 16px; border-bottom:1px solid #1a2432; background:#0e141d; display:flex; align-items:center; gap:10px; }
    .header-avatar { width:40px; height:40px; border-radius:50%; }
    @media (min-width:600px){ .header-avatar{ width:44px; height:44px;} }
    .header-text h1 { margin:0; font-size:18px; }
    .header-text .sub { font-size:12px; opacity:.65; }
    .chat { flex:1; overflow-y:auto; padding:16px; display:flex; flex-direction:column; gap:12px; }
    .row { display:flex; }
    .row.user { justify-content:flex-end; }
    .row.bot { justify-content:flex-start; }
    .bubble { max-width:85%; padding:10px 14px; border-radius:16px; white-space:pre-wrap; font-size:14px; }
    .user .bubble { background:#1e3a5f; border-bottom-right-radius:4px; }
    .bot .bubble { background:#1a2432; border-bottom-left-radius:4px; }
    .typing .bubble { font-style:italic; opacity:.6; }
    .more-btn { align-self:flex-start; padding:8px 14px; background:#0e141d; border:1px solid #2a3b54; border-radius:12px; color:#9fc5ff; }
    .bar { display:flex; gap:10px; padding:12px 16px; border-top:1px solid #1a2432; background:#0e141d; }
    .bar input { flex:1; padding:12px 14px; border-radius:20px; border:1px solid #1a2432; background:#0b1017; color:#e8eef7; }
    .send-btn { width:44px; height:44px; border-radius:50%; background:#1e3a5f; border:none; color:#e8eef7; }

    /* ADMIN */
    .modal-overlay{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.7); z-index:100; align-items:flex-end; justify-content:center; }
    .modal-overlay.open{ display:flex; }
    .modal{ width:100%; max-width:480px; background:#0e141d; border-radius:20px 20px 0 0; padding:16px; }
    textarea{ width:100%; min-height:140px; background:#0b1017; color:#e8eef7; border:1px solid #1a2432; border-radius:10px; padding:10px; }
    .submit-btn{ width:100%; margin-top:10px; padding:14px; background:#1e3a5f; color:#e8eef7; border:none; border-radius:12px; }
  </style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <img class="header-avatar" src="./dancemap-icon.svg" />
    <div class="header-text"><h1>DanceMap</h1><div class="sub">Kun danseevents i København</div></div>
  </div>
  <div id="chat" class="chat"></div>
  <div class="bar">
    <input id="q" placeholder="Skriv fx: salsa i dag" />
    <button id="sendBtn" class="send-btn">➤</button>
  </div>
</div>

<div class="modal-overlay" id="adminModal">
  <div class="modal">
    <h2>Admin – Paste / Scrape</h2>
    <textarea id="adminPaste" placeholder="Indsæt tekst eller URL her"></textarea>
    <button class="submit-btn" id="adminSubmit">Tilføj event</button>
    <div id="adminStatus"></div>
  </div>
</div>

<script>
const API_URL = 'DIN_APPS_SCRIPT_URL';
const isAdmin = new URLSearchParams(location.search).get('admin')==='1';
const modal = document.getElementById('adminModal');

if(isAdmin){
  document.addEventListener('keydown',e=>{
    if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='a'){
      e.preventDefault(); modal.classList.toggle('open');
    }
  });
}

document.getElementById('adminSubmit').onclick = async ()=>{
  const text = document.getElementById('adminPaste').value.trim();
  const res = await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'admin-import',payload:text})});
  const data = await res.json();
  document.getElementById('adminStatus').textContent = data.text;
};
</script>
</body>
</html>
```

---

# Code.gs

```javascript
const SHEET_ID = 'DIN_SHEET_ID';
const EVENTS_SHEET = 'Events';

function doGet(e){
  return json({success:true,text:'OK',hasMore:false});
}

function doPost(e){
  const data = JSON.parse(e.postData.contents||'{}');
  if(data.action!=='admin-import') return json({success:false,text:'Ukendt action',hasMore:false});

  const parsed = parseInput(data.payload);
  if(!parsed.ok) return json({success:false,text:parsed.error,hasMore:false});

  const sheet = SpreadsheetApp.openById(SHEET_ID).getSheetByName(EVENTS_SHEET);
  const rows = sheet.getDataRange().getDisplayValues().slice(1);

  for(const r of rows){
    if(r[0]===parsed.dato && r[1]===parsed.starttid && r[4]===parsed.sted){
      return json({success:false,text:'Dublet – event findes allerede.',hasMore:false});
    }
  }

  sheet.appendRow([
    parsed.dato, parsed.starttid, parsed.sluttid, parsed.dansetype,
    parsed.sted, parsed.adresse, 'København', parsed.pris,
    '', parsed.link, 'active', 'none'
  ]);

  return json({success:true,text:'✅ Event tilføjet.',hasMore:false});
}

function parseInput(t){
  if(t.startsWith('http')){
    if(!t.includes('salsa.dk')) return {ok:false,error:'Kun salsa.dk understøttes'};
    const html = UrlFetchApp.fetch(t).getContentText();
    return {ok:true,dato:'',starttid:'',sluttid:'',dansetype:'Salsa',sted:'',adresse:'',pris:'',link:t};
  }
  const lines = t.split(/\n+/);
  return {ok:true,dato:'',starttid:'',sluttid:'',dansetype:'Salsa',sted:lines[0]||'',adresse:'',pris:'',link:''};
}

function json(o){
  return ContentService.createTextOutput(JSON.stringify(o)).setMimeType(ContentService.MimeType.JSON);
}
```
