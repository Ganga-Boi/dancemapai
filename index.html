<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>DanceMap</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#6366f1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="DanceMap" />
  <link rel="apple-touch-icon" href="/icon-192.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif;
      background:#0d1117;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
      color:#e6edf3
    }
    .card{
      background:#161b22;
      border-radius:20px;
      width:100%;
      max-width:400px;
      display:flex;
      flex-direction:column;
      box-shadow:0 8px 32px rgba(0,0,0,.4)
    }
    .header{
      padding:20px;
      border-bottom:1px solid #21262d;
      cursor:pointer
    }
    .chat{padding:20px;flex:1;overflow-y:auto}
    .input-area{padding:16px;border-top:1px solid #21262d;display:flex;gap:12px}
    .input-area input{
      flex:1;padding:14px;border-radius:12px;border:1px solid #30363d;
      background:#0d1117;color:#e6edf3
    }
    .send-btn{
      width:48px;height:48px;border-radius:12px;border:none;
      background:#6366f1;color:#fff;cursor:pointer
    }
    .version-info{
      font-size:11px;color:#7d8590;text-align:center;padding:8px
    }
  </style>
</head>

<body>
<div class="card">
  <div class="header">
    <strong>DanceMap</strong><br>
    <small>Danseevents i København</small>
  </div>

  <div id="chat" class="chat">
    <div>Skriv fx: <em>salsa</em> eller <em>bachata</em></div>
  </div>

  <div class="input-area">
    <input id="q" placeholder="Søg events…" />
    <button id="sendBtn" class="send-btn">→</button>
  </div>

  <div id="backendVersion" class="version-info"></div>
</div>

<script>
/* ═════════════════════════════════════════════
   VERSION & API (KUN DENNE ER NY)
   ═════════════════════════════════════════════ */
const FRONTEND_VERSION = 'v6.0.1-2025-01-12';
const API = 'https://script.google.com/macros/s/AKfycbyJdVscl-4f-ow7Ynj-LGsazpGFSR8VzVZWHruWdNE66HbVK6LJLOXKRmS6TFUUFC6i/exec';

/* helpers */
const $ = id => document.getElementById(id);

function jsonp(url){
  return new Promise((resolve,reject)=>{
    const cb='cb_'+Date.now();
    window[cb]=d=>{delete window[cb];s.remove();resolve(d)};
    const s=document.createElement('script');
    s.src=url+(url.includes('?')?'&':'?')+'callback='+cb;
    s.onerror=()=>reject();
    document.body.appendChild(s);
  });
}

/* version check */
(async function(){
  try{
    const d=await jsonp(API+'?action=ping');
    const el=$('backendVersion');
    if(d.version){
      el.textContent=`Backend: ${d.version} | Frontend: ${FRONTEND_VERSION}`;
      el.style.color = d.version===FRONTEND_VERSION ? '#3fb950' : '#f85149';
    }
  }catch(e){}
})();
</script>
</body>
</html>
